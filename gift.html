<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gift</title>
  <style>
   :root{
    --sky1:#0b1730; --sky2:#020617;
    /* Fixed card size */
    --w: 1050px;
    --h: 600px;
  }
  *{box-sizing:border-box}
  html,body{
    height:100%;margin:0;overflow:hidden;
    background:radial-gradient(1400px 900px at 50% 60%,var(--sky1),var(--sky2));
    font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  }
  /* canvases */
  canvas.bg{position:fixed;inset:0;z-index:0;pointer-events:none}
  /* gradient title */
  .title{
    position:fixed;top:6px;left:50%;transform:translateX(-50%);
    font-size:clamp(28px,6vw,56px);
    font-weight:700; line-height:1.1;
    font-family:"Brush Script MT","Segoe Script","Lucida Handwriting","Snell Roundhand",cursive;
    background:linear-gradient(90deg,#ff9f6a,#ffd93d,#b6ffcc,#6bdfff,#b49cff);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow:0 2px 6px rgba(0,0,0,.35);
    letter-spacing:.5px;
    z-index:5; user-select:none; white-space:nowrap;
  }
  /* side flowers */
  .flowers{position:fixed;top:0;bottom:0;width:140px;display:flex;flex-direction:column;justify-content:space-evenly;align-items:center;gap:12px;z-index:3;pointer-events:none}
  .flowers.left{left:0}
  .flowers.right{right:0;transform:scaleX(-1)}
  .flower{width:120px;height:184px;filter:drop-shadow(0 2px 3px rgba(0,0,0,.25));animation:sway 6s ease-in-out infinite alternate}
  .flower svg{display:block;width:100%;height:auto}
  @keyframes sway{from{transform:rotate(-2.5deg)}to{transform:rotate(2.5deg)}}
  /* stage + card */
  .stage{position:fixed;inset:0;display:grid;place-items:center;z-index:4;perspective:1400px;padding-top:54px;padding-bottom:44px}
  .card{
    width:var(--w);
    height:var(--h);
    border-radius:18px;overflow:hidden;background:#111;
    box-shadow:0 20px 60px rgba(0,0,0,.5),0 0 0 1px rgba(255,255,255,.06);
    position:relative;cursor:pointer
  }
  .card > img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
  .card::after{content:'';position:absolute;inset:0;background:linear-gradient(60deg,transparent 40%,rgba(255,255,255,.15) 50%,transparent 60%);transform:translateX(-120%);transition:transform .9s}
  .card:hover::after{transform:translateX(120%)}
  /* CTA */
  .cta{
    position:fixed;left:50%;bottom:10px;transform:translateX(-50%);
    z-index:5;border:0;border-radius:999px;padding:12px 20px;font-weight:900;letter-spacing:.3px;cursor:pointer;
    color:#1a1a1a;background:linear-gradient(90deg,#ff6b6b,#ffd93d,#6bcbff,#b16bff,#7dd87d);
    background-size:300% 100%;
    box-shadow:0 10px 26px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.15);
    animation:gradMove 6s linear infinite;
  }
  @keyframes gradMove{0%{background-position:0% 50%}100%{background-position:100% 50%}}
  .cta:hover{transform:translateX(-50%) translateY(-2px)}
  .cta:active{transform:translateX(-50%) scale(.98)}
  /* reveal */
  .reveal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;z-index:6;backdrop-filter:blur(3px);transition:opacity .3s ease}
  .reveal.open{opacity:1;pointer-events:auto}
  .iris{position:relative;border-radius:16px;overflow:hidden;clip-path:circle(0% at 50% 50%);transform:scale(.94)}
  .iris img{display:block;max-width:100%;max-height:92vh;width:auto;height:auto;background:#000}

  /* Music control button */
  .music-control{
    position: fixed; right:16px; bottom:16px; z-index:8;
    width:48px; height:48px; border-radius:50%;
    border:1px solid rgba(255,255,255,.2);
    background: radial-gradient(120% 120% at 30% 30%, #9a8cff, #6b56ff);
    color:#fff; font-size:20px; line-height:48px; text-align:center; cursor:pointer;
    box-shadow: 0 8px 22px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.08);
    transition: transform .08s ease, box-shadow .2s ease, opacity .2s ease;
  }
  .music-control.playing{ box-shadow: 0 0 0 3px rgba(122,252,255,.35), 0 8px 22px rgba(0,0,0,.45) }
  .music-control:active{ transform: translateY(1px) }
  .music-control[disabled]{ opacity:.65; cursor:not-allowed }

  /* End screen */
  .end{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);backdrop-filter:blur(3px);z-index:9;opacity:0;pointer-events:none;transition:opacity .25s ease}
  .end.open{opacity:1;pointer-events:auto}
  .end-card{background:linear-gradient(180deg, rgba(30,30,60,.6), rgba(18,18,36,.9));border:1px solid rgba(255,255,255,.12);padding:18px 20px;border-radius:14px;box-shadow:0 30px 80px rgba(0,0,0,.6), inset 0 1px 0 rgba(255,255,255,.08);color:#fff;text-align:center;min-width:280px}
  .end-card h3{margin:0 0 10px;font-size:22px}
  .end-card .btn{border:none;border-radius:10px;padding:10px 14px;font-weight:800;cursor:pointer;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}

  /* Emoji burst layer */
  .emoji-layer{position:fixed;inset:0;pointer-events:none;z-index:10;overflow:hidden}
  .emoji{position:absolute;bottom:-28px;font-size:clamp(20px,3.5vmin,34px);filter:drop-shadow(0 2px 2px rgba(0,0,0,.35));animation:floatUp var(--dur,2.1s) ease-out forwards}
  @keyframes floatUp{
    0%{transform:translateY(0) translateX(0);opacity:0}
    10%{opacity:1}
    100%{transform:translateY(-120vh) translateX(var(--dx,0px));opacity:0}
  }

  @media (max-width:900px){ .flowers{display:none} }
  </style>
</head>
<body>
  <!-- Background music (autoplay ensured via muted->unmute fade-in) -->
  <audio id="bgm" preload="auto" autoplay loop playsinline muted>
    <source src="audio/audio2.mp3" type="audio/mpeg">
  </audio>
  <button id="musicBtn" class="music-control" aria-label="Toggle music" aria-pressed="false" title="Music">üéµ</button>

  <canvas id="stars" class="bg"></canvas>
  <canvas id="fireworks" class="bg"></canvas>
  <canvas id="balloons" class="bg"></canvas>

  <!-- side flowers -->
  <div class="flowers left" id="flLeft"></div>
  <div class="flowers right" id="flRight"></div>

  <div class="title">Small Gift For You </div>

  <div class="stage">
    <div class="card" id="card" aria-label="Gift card">
      <img src="image/im.jpg" alt="Gift cover">
    </div>
  </div>

  <button class="cta" id="ctaBtn">Click the image</button>

  <div class="reveal" id="reveal" aria-hidden="true">
    <div class="iris" id="iris"><img src="image/im2.jpg" alt="Gift reveal"></div>
  </div>

  <!-- End screen with OK -->
  <div class="end" id="theEnd" aria-hidden="true">
    <div class="end-card">
      <h3>That's All For Now ‚ù§Ô∏è</h3>
      <button class="btn" id="okBtn">OK</button>
    </div>
  </div>

  <!-- Emoji burst layer -->
  <div class="emoji-layer" id="emojiLayer" aria-hidden="true"></div>

  <script>
  /* ===== helpers ===== */
  const rand=(a,b)=>a+Math.random()*(b-a);
  function fitCanvas(c){
    const dpr=Math.min(2,window.devicePixelRatio||1);
    const w=innerWidth, h=innerHeight;
    c.width=w*dpr; c.height=h*dpr; c.style.width=w+'px'; c.style.height=h+'px';
    const ctx=c.getContext('2d'); ctx.setTransform(dpr,0,0,dpr,0,0);
    return {ctx,w,h};
  }

  /* ===== stars ===== */
  (function(){
    const c=document.getElementById('stars'); let {ctx,w:W,h:H}=fitCanvas(c);
    addEventListener('resize',()=>({ctx,W,H}=fitCanvas(c)),{passive:true});
    let stars=[],shootTimer=0;
    const count=Math.min(420,Math.floor(W*H/4500));
    for(let i=0;i<count;i++){
      stars.push({x:Math.random()*W,y:Math.random()*H,r:Math.random()*1.2+0.4,vx:(Math.random()-.5)*0.05,vy:(Math.random()-.5)*0.05,a:Math.random()*0.5+0.5});
    }
    function addShooting(){ const dir=Math.random()<.5?1:-1, y=Math.random()*H*0.6+H*0.1, x=dir===1?-40:W+40; stars.push({x,y,r:1.8+Math.random()*1.2,vx:dir*(2.4+Math.random()*1.4),vy:(Math.random()-.4)*0.6,a:1,life:220}); }
    (function step(){
      ctx.clearRect(0,0,W,H);
      if(++shootTimer>240){addShooting();shootTimer=0;}
      for(let i=stars.length-1;i>=0;i--){
        const s=stars[i]; s.x+=s.vx; s.y+=s.vy;
        if(s.life){ s.life--; s.a=s.life/220; if(s.life<=0){stars.splice(i,1); continue;} }
        if(s.x<-10) s.x=W+10; if(s.x>W+10) s.x=-10;
        if(s.y<-10) s.y=H+10; if(s.y>H+10) s.y=-10;
        ctx.globalAlpha=s.a; ctx.fillStyle="#cfe7ff"; ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,6.283); ctx.fill();
        if(s.life){ ctx.globalAlpha=s.a*0.6; ctx.strokeStyle="#e6f3ff"; ctx.lineWidth=1; ctx.beginPath(); ctx.moveTo(s.x-12*s.vx, s.y-12*s.vy); ctx.lineTo(s.x,s.y); ctx.stroke(); }
      }
      requestAnimationFrame(step);
    })();
  })();

  /* ===== fireworks ===== */
  (function(){
    const c=document.getElementById('fireworks'); let {ctx,w:W,h:H}=fitCanvas(c);
    addEventListener('resize',()=>({ctx,W,H}=fitCanvas(c)),{passive:true});
    const rockets=[], parts=[];
    const palettes=[['#ff6b6b','#ffd93d','#6bcbff','#b16bff','#7dd87d'],['#ff9f9f','#ffa94d','#f7aef8','#70d6ff','#b8f2e6'],['#ffe66d','#ff5d8f','#8bd3dd','#c77dff','#7bf1a8']];
    function launch(){ rockets.push({x:rand(W*0.1,W*0.9), y:H+14, vx:(Math.random()-.5)*1.2, vy:-rand(7.8,10.2), colorSet: palettes[(Math.random()*palettes.length)|0], topY: rand(H*0.08, H*0.22), trail: [], life: 140}); }
    setInterval(launch, 650);
    function explode(r){ const n=140+Math.random()*100, cols=r.colorSet; for(let i=0;i<n;i++){ const a=Math.random()*Math.PI*2, sp=rand(2.4,5.6); parts.push({x:r.x,y:r.y,vx:Math.cos(a)*sp,vy:Math.sin(a)*sp,g:0.035,drag:0.991,life: 110+Math.random()*60,r: rand(1.8,3.6), color: cols[(Math.random()*cols.length)|0], glow: Math.random()*.6+.5}); } }
    (function step(){
      ctx.clearRect(0,0,W,H);
      for(let i=rockets.length-1;i>=0;i--){
        const r=rockets[i]; r.x+=r.vx; r.y+=r.vy; r.vy+=0.05; r.life--;
        r.trail.push({x:r.x,y:r.y,alpha:1}); if(r.trail.length>16) r.trail.shift();
        for(const t of r.trail){ t.alpha*=0.86; ctx.globalCompositeOperation='lighter'; ctx.globalAlpha=t.alpha*0.8; ctx.fillStyle='#fff'; ctx.beginPath(); ctx.arc(t.x,t.y,2.6,0,6.283); ctx.fill(); ctx.globalCompositeOperation='source-over'; }
        ctx.globalAlpha=1; ctx.fillStyle='#fff'; ctx.beginPath(); ctx.arc(r.x,r.y,3.6,0,6.283); ctx.fill();
        if(r.y<=r.topY || r.life<=0){ explode(r); rockets.splice(i,1); }
      }
      for(let i=parts.length-1;i>=0;i--){
        const p=parts[i]; p.x+=p.vx; p.y+=p.vy; p.vy+=p.g; p.vx*=p.drag; p.vy*=p.drag; p.life--;
        ctx.globalCompositeOperation='lighter'; ctx.globalAlpha=Math.max(0,p.life/140)*p.glow;
        const grd=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*4.5); grd.addColorStop(0,p.color); grd.addColorStop(1,'rgba(0,0,0,0)'); ctx.fillStyle=grd; ctx.beginPath(); ctx.arc(p.x,p.y,p.r*4.5,0,6.283); ctx.fill();
        ctx.globalCompositeOperation='source-over'; if(p.life<=0) parts.splice(i,1);
      }
      requestAnimationFrame(step);
    })();
  })();

  /* ===== balloons ===== */
  const BalloonEmitter=(function(){
    const c=document.getElementById('balloons'); let ctx,W,H; let active=false, balloons=[];
    function resize(){ ({ctx,w:W,h:H}=fitCanvas(c)); } resize(); addEventListener('resize',resize,{passive:true});
    const colors=['#ff6b9d','#4ecdc4','#ffe66d','#6bcbff','#b16bff','#7dd87d','#ffa94d'];
    function spawn(){
      const size=rand(18,40);
      balloons.push({x:rand(0,W), y:H+size, vx:rand(-0.25,0.25), vy:rand(-1.8,-1.0), size, color:colors[(Math.random()*colors.length)|0], sway: rand(0.008,0.02), life: rand(340,560), burst:12});
    }
    let t=0;
    function step(){
      ctx.clearRect(0,0,W,H);
      if(active){ if(++t%5===0) spawn(); }
      for(let i=balloons.length-1;i>=0;i--){
        const b=balloons[i];
        if(b.burst>0){
          const k = 1 + (b.burst/12)*0.6;
          draw(b.x,b.y,b.size*k,b.color, 0.5*(b.burst/12));
          b.burst--;
        }else{
          b.x += b.vx + Math.sin(b.life*b.sway)*0.5; b.y += b.vy; b.life--; draw(b.x,b.y,b.size,b.color,0);
        }
        if(b.y<-60 || b.life<=0){ balloons.splice(i,1); }
      }
      requestAnimationFrame(step);
    }
    function draw(x,y,s,color,glow){
      ctx.save(); ctx.translate(x,y);
      if(glow>0){ const g=ctx.createRadialGradient(0,0,0,0,0,s*1.4); g.addColorStop(0, color+'aa'); g.addColorStop(1,'rgba(0,0,0,0)'); ctx.globalCompositeOperation='lighter'; ctx.globalAlpha=glow; ctx.fillStyle=g; ctx.beginPath(); ctx.arc(0,0,s*1.4,0,6.283); ctx.fill(); ctx.globalCompositeOperation='source-over'; ctx.globalAlpha=1; }
      const grd=ctx.createRadialGradient(0,-s*0.4,1,0,-s*0.4,s); grd.addColorStop(0,'#fff'); grd.addColorStop(0.2,'#fff8'); grd.addColorStop(1,color);
      ctx.fillStyle=grd; ctx.beginPath(); ctx.ellipse(0,0,s*0.75,s,0,0,6.283); ctx.fill();
      ctx.fillStyle=color; ctx.beginPath(); ctx.moveTo(0,s*0.9); ctx.lineTo(-4,s*1.05); ctx.lineTo(4,s*1.05); ctx.closePath(); ctx.fill();
      ctx.strokeStyle='#ffffffaa'; ctx.lineWidth=1; ctx.beginPath(); ctx.moveTo(0,s*1.05); ctx.bezierCurveTo(6,s*1.25,-6,s*1.55,0,s*1.85); ctx.stroke();
      ctx.restore();
    }
    function start(){ active=true; }
    function stop(){ active=false; balloons.length=0; }
    step();
    return {start,stop};
  })();

  /* ===== side flowers (SVG) ===== */
  (function(){
    const L=document.getElementById('flLeft'), R=document.getElementById('flRight');
    function daisy(center='#ffcf3f', petal='#ffffff'){
      return `
      <svg viewBox="0 0 120 184" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <defs><linearGradient id="stem" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#43d07a"/><stop offset="100%" stop-color="#0f6a3b"/></linearGradient></defs>
        <g transform="translate(18,10)">
          <path d="M44 60 C 46 108, 46 136, 46 170" stroke="url(#stem)" stroke-width="10" fill="none" stroke-linecap="round"/>
          <ellipse cx="34" cy="120" rx="18" ry="8" fill="url(#stem)" transform="rotate(-20 34 120)"/>
          <ellipse cx="64" cy="130" rx="18" ry="8" fill="url(#stem)" transform="rotate(20 64 130)"/>
          <g transform="translate(46,60)">
            ${Array.from({length:14}).map((_,i)=>`<ellipse cx="${Math.cos(i*25*Math.PI/180)*24}" cy="${Math.sin(i*25*Math.PI/180)*20}" rx="10" ry="22" fill="${petal}" transform="rotate(${i*25})" />`).join('')}
            <circle cx="0" cy="0" r="12" fill="${center}"/>
          </g>
        </g>
      </svg>`;
    }
    function tulip(petal='#ff6b9d'){
      return `
      <svg viewBox="0 0 120 184" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <defs><linearGradient id="stem2" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#43d07a"/><stop offset="100%" stop-color="#0f6a3b"/></linearGradient></defs>
        <g transform="translate(18,10)">
          <path d="M50 70 C 52 116, 50 140, 50 170" stroke="url(#stem2)" stroke-width="10" fill="none" stroke-linecap="round"/>
          <ellipse cx="36" cy="128" rx="18" ry="8" fill="url(#stem2)" transform="rotate(-22 36 128)"/>
          <ellipse cx="66" cy="138" rx="18" ry="8" fill="url(#stem2)" transform="rotate(22 66 138)"/>
          <g transform="translate(50,70)">
            <path d="M0 0 C -16 -20, -28 12, 0 34 C 28 12, 16 -20, 0 0 Z" fill="${petal}"/>
            <path d="M-6 -2 C -10 -16, -18 6, 0 18" fill="${petal}" opacity="0.9"/>
            <path d="M6 -2 C 10 -16, 18 6, 0 18" fill="${petal}" opacity="0.9"/>
          </g>
        </g>
      </svg>`;
    }
    function add(container,svg){ const el=document.createElement('div'); el.className='flower'; el.innerHTML=svg; container.appendChild(el); }
    const count=7; for(let i=0;i<count;i++){ add(L, i%2?daisy():tulip()); add(R, i%2?tulip('#ff8fb7'):daisy()); }
  })();

  /* ===== reveal flow + end screen OK ===== */
  (function(){
    const card=document.getElementById('card');
    const btn=document.getElementById('ctaBtn');
    const layer=document.getElementById('reveal');
    const iris=document.getElementById('iris');
    const end=document.getElementById('theEnd');
    const okBtn=document.getElementById('okBtn');

    function openReveal(){
      layer.classList.add('open'); layer.setAttribute('aria-hidden','false');
      iris.style.clipPath='circle(0% at 50% 50%)'; iris.style.transform='scale(.94)'; iris.style.filter='blur(8px)';
      const supportsClip = CSS && CSS.supports && CSS.supports('clip-path','circle(50% at 50% 50%)');
      if(iris.animate){
        iris.animate([
          {clipPath:supportsClip?'circle(0% at 50% 50%)':'none', transform:'scale(.94)', filter:'blur(8px)'},
          {clipPath:supportsClip?'circle(150% at 50% 50%)':'none', transform:'scale(1)', filter:'blur(0px)'}
        ],{duration:920,easing:'cubic-bezier(.2,.8,.2,1)',fill:'forwards'});
      }else{ iris.style.clipPath='none'; iris.style.transform='scale(1)'; iris.style.filter='none'; }
      BalloonEmitter.start();
    }
    function closeReveal(){
      const afterClose = ()=>{
        layer.classList.remove('open');
        layer.setAttribute('aria-hidden','true');
        BalloonEmitter.stop();
        // show end screen
        end.classList.add('open');
        end.setAttribute('aria-hidden','false');
      };
      if(iris.animate){
        const a=iris.animate([{transform:'scale(1)',filter:'none'},{transform:'scale(.94)',filter:'blur(6px)'}],{duration:340,easing:'cubic-bezier(.6,0,.8,1)',fill:'forwards'});
        a.onfinish=afterClose;
      }else{ afterClose(); }
    }
    card.addEventListener('click',openReveal);
    btn.addEventListener('click',openReveal);
    document.getElementById('reveal').addEventListener('click',closeReveal);

    okBtn.addEventListener('click', ()=>{
      runEmojiBurst(28);
      // return to main gift view by closing the end overlay shortly after
      setTimeout(()=>{
        end.classList.remove('open');
        end.setAttribute('aria-hidden','true');
      }, 900);
    });
  })();

  /* ===== Emoji burst ===== */
  function runEmojiBurst(n=24){
    const layer = document.getElementById('emojiLayer');
    const EMOJIS = ['üå∏','üíê','üå∑','üå∫','üåº','üåª'];
    for(let i=0;i<n;i++){
      const span = document.createElement('span');
      span.className = 'emoji';
      span.textContent = EMOJIS[(Math.random()*EMOJIS.length)|0];
      span.style.left = Math.round(Math.random()*92+4)+'vw';
      span.style.setProperty('--dx', Math.round(rand(-40,40))+'px');
      span.style.setProperty('--dur', (rand(1.4,2.4))+'s');
      span.style.fontSize = Math.round(rand(20,36))+'px';
      layer.appendChild(span);
      span.addEventListener('animationend', ()=> span.remove());
    }
  }

  /* ===== bg music: autoplay (muted->fade-in) + time persistence ===== */
  (function(){
    const audio=document.getElementById('bgm');

    // Restore last time if any
    try{
      const t = parseFloat(localStorage.getItem('musicTime') || '0');
      if(!Number.isNaN(t)) audio.currentTime = Math.max(0, t);
    }catch(e){}

    // Start muted for policy compliance, then unmute and fade in
    audio.volume = 0.0;
    audio.muted = true;

    function startMutedPlay(){
      audio.play().then(()=>{
        setTimeout(()=>{
          audio.muted = false;
          const target = 0.6; let v = 0.0;
          const iv = setInterval(()=>{ v = Math.min(target, v+0.06); audio.volume=v; if(v>=target) clearInterval(iv); },120);
        }, 350);
      }).catch(()=>{ /* retry on visibility or first gesture */ });
    }

    // Kick off without user gesture where possible
    if (document.readyState === 'complete' || document.readyState === 'interactive') startMutedPlay();
    else window.addEventListener('load', startMutedPlay, { once:true });

    document.addEventListener('visibilitychange', ()=>{
      if(document.visibilityState==='visible' && audio.paused) startMutedPlay();
    });

    // Persist time
    const persist = () => { try{ localStorage.setItem('musicTime', String(audio.currentTime||0)); }catch(e){} };
    window.addEventListener('pagehide', persist);
    window.addEventListener('beforeunload', persist);

    // One-time unlock as final fallback
    function unlock(){ if(audio.paused) startMutedPlay(); window.removeEventListener('pointerdown',unlock); window.removeEventListener('keydown',unlock); }
    window.addEventListener('pointerdown', unlock, { once:true });
    window.addEventListener('keydown', unlock, { once:true });
  })();

  /* ===== Music control button ===== */
  (function(){
    const audio = document.getElementById('bgm');
    const btn = document.getElementById('musicBtn');
    if(!audio || !btn) return;

    // Reflect live state
    function setState(p){
      btn.classList.toggle('playing', p);
      btn.setAttribute('aria-pressed', String(p));
      btn.textContent = p ? 'üîä' : 'üîá';
    }
    audio.addEventListener('play', ()=> setState(true));
    audio.addEventListener('pause', ()=> setState(false));

    // Toggle
    btn.addEventListener('click', ()=>{
      if(audio.paused){
        audio.play().then(()=> setState(true)).catch(()=> setState(false));
      }else{
        audio.pause(); setState(false);
      }
    });

    // Initialize visual state
    setState(!audio.paused);
  })();
  </script>
</body>
</html>
